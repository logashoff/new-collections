<mat-accordion>
  <mat-expansion-panel
    *ngFor="let group of groups; trackBy: trackByGroupId"
    [expanded]="(activeGroupId$ | async) === group.id && !isNaN(activeTabId$ | async)"
    hideToggle>
    <mat-expansion-panel-header>
      <app-ripple [focused]="(activeGroupId$ | async) === group.id && isNaN(activeTabId$ | async)"></app-ripple>
      <div class="collapsed">
        <app-panel-header
          *ngIf="tabsByHostname$ | async as tabsByHostname"
          [icons]="tabsByHostname[group.id]"
          [total]="group.tabs.length"
          [pinned]="group.timestamp < 0"
          [readOnly]="!hasTabGroup(group)"
          (starred)="favGroup(group)">
        </app-panel-header>
      </div>
      <div class="expanded">
        <app-group-controls [group]="group" [readOnly]="!hasTabGroup(group)"></app-group-controls>
      </div>
    </mat-expansion-panel-header>
    <mat-divider></mat-divider>
    <app-tab-list>
      <app-list-item
        *ngFor="let tab of group.tabs$ | async; trackBy: trackByTabId"
        [tab]="tab"
        [focused]="(activeGroupId$ | async) === group.id && (activeTabId$ | async) === tab.id">
      </app-list-item>
    </app-tab-list>
  </mat-expansion-panel>
</mat-accordion>
